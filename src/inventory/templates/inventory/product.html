

{%extends 'home/base.html'%}

{%block style%}
{% load static %}
<link rel="stylesheet" href="{% static "css/floating-labels.css" %}" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
{%endblock%}

{%block content%}


<div id="product">
<div class="row">
<div class="col-md-8">
             <form class="form-signin" v-on:submit="checkSubmitItemForm">
    {% csrf_token %}
<!--       <div class="form-label-group">
        <input type="text" id="inpuitemname" class="form-control" placeholder="Product name" v-model='selected' required autofocus>
        <label for="inpuitemname">Item</label>
      </div> -->

      <div class="input-group mb-3">
    <div class="input-group-prepend">
      <label class="input-group-text" for="inputGroupSelect01">Store</label>
    </div>
    <select   class="custom-select" id="inputGroupSelect02">
      <option disabled value="" >Choose</option>
      <option >Oceaniic Kariakoo</option>
    </select>
  </div>

      <div class="form-label-group">
        <input type="text" id="inputitemname" class="form-control" placeholder=" Product Name"  required autofocus v-model="itemname">
        <label for="inputitemname">Product Name </label>
      </div>
      <div class="form-label-group">
        <input type="text" id="inputitemprice" class="form-control" placeholder="Procuct Price"   autofocus v-model="itemprice">
        <label for="inputitemprice">Product Price</label>
      </div>


      <div class="form-label-group">
        <input type="text" id="inputitemquantity2" class="form-control" placeholder=" Quantity" v-model='itemsize'  autofocus>
        <label for="inputitemquantity2">Quantity </label>
      </div>

      <div class="form-label-group">
        <input type="text" id="inputitemmanufucture" class="form-control" placeholder="Product manufucturer"   autofocus v-model="itemmanufucture">
        <label for="inputitemmanufucture">Product Manufucturer</label>
      </div>

  
      <button class="btn btn-lg btn-dark btn-block" type="submit">[[button_create_edit]]</button>
      <!-- <p class="mt-5 mb-3 text-muted text-center">&copy; 2017-2018</p> -->
    </form>
  
</div>
<div class="col-mid-4" style="width:30%">

  <ul class="list-group">
     
   <li class="list-group-item d-flex justify-content-between lh-condensed">
        <div>
        <h4  class="my-0" >  Name </h4>
        <small class="text-muted"> Quantity </small>
      </div>
      <div>
      <h4 class="my-0"> Manufucturer </h4>
      <small class="text-muted"> Price </small>
        
      </div>
      
      
  </li>

</ul> 
<div style="max-height: 500px;
  overflow-y: auto;
  overflow-x: auto;">

   <ul class="list-group">


      <li class="list-group-item d-flex justify-content-between lh-condensed" style="margin-top:10px" v-for="item in items" v-on:dblclick="editItem(item.id,item.item_name,item.item_size,item.item_price,store,item.item_manufucture)" v-cloak>

              <div> 
          <h6  class="my-0"> [[item.item_name]] </h6>
          <small class="text-muted"> [[item.item_size]] </small>
        </div>

      <div>
      <h6  class="my-0"> [[item.item_manufucture]] 
        
      </h6>
        <small class="text-muted"> [[item.item_price]] </small>
        
      </div>
     
<i id="trashitem" class="fa fa-trash fa-2x pull-right" v-on:click="deleteItem(item.id)"></i>
                
              </li>


   </ul>

</div>

  
</div>
  

</div>

  

</div>
{%endblock%}

{%block script%}
  <script >
    new Vue({
  delimiters: ['[[', ']]'],
  el: '#product',
  data: {
    currenteditid:0,
    edit:false,
    items:'',
    itemname: '',
    itemprice:'',
    itemmanufucture:'',
    itemcolor:'',
    itemsize:'',
    store:1,
    selectestore:'',
    button_create_edit:'New Product',
  },
  methods:{
    checkSubmitItemForm:function(e){  
      if(this.edit){
        // updating editing item
        this.$http.put('/api/item/'+this.currenteditid+'/',{'item_name':this.itemname,'item_price':this.itemprice,'item_size':this.itemsize,'item_manufucture':this.itemmanufucture,'store':this.store})
       .then(function(response){
        // this.items=response.data
        this.title=response.data
        this.edit=false;
        this.itemname='';
         this.itemprice='';
         this.itemsize='';
         this.itemmanufucture='';
         this.getItems();
        
         this.button_create_edit="New Product";
       })
       .catch(function(error){
        this.title='error getting items'
       })
        

      }  else{
        this.$http.post('/api/item/',{'item_name':this.itemname,'item_price':this.itemprice,'item_size':this.itemsize,'item_manufucture':this.itemmanufucture,'store':this.store})
       .then(function(response){
        // this.items=response.data
        this.title=response.data
         // this.getSales()
         this.itemname='';
         this.itemprice='';
         this.itemsize='';
         this.itemmanufucture='';
         this.getItems();

        // alert('response')
       })
       .catch(function(error){
        this.title='error getting items'
       })

      }         
        

      e.preventDefault();
    },
    getItems:function(){
     this.$http.get('/api/item')
     .then(function(response){
      this.items=response.data
     })
     .catch(function(error){
      this.title='error getting items'
     })
    },
    editItem:function(id,name,qunatity,price,store,mauufucture){
         this.currenteditid=id;
         this.button_create_edit="Edit Product";
         this.edit=true ;
         this.itemname=name;
         this.itemprice=price;
         this.itemsize=qunatity;
         this.itemmanufucture=mauufucture;
    },
    deleteItem:function(id){
      this.$http.delete('/api/item/'+id+'/')
       .then(function(response){
        // this.items=response.data
        this.title=response.data
        this.getItems()
        // alert('response')
       })
       .catch(function(error){
        this.title='error getting items'
       })

    },
  },
    beforeMount(){
      this.getItems()
    }
})

  </script>
{%endblock%}